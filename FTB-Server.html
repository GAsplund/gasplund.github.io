<!DOCTYPE html>

<html>

	<head>

		<title>GAsplund's Website</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

		<!-- META -->
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- OPEN GRAPH PROTOCOL -->
		<meta property="og:site_name" content="GAsplund's Website">
		<meta property="og:title" content="GAsplund's Website">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://gasplund.github.io">
		<meta property="og:image" content="favicon.ico">
		<meta property="og:description" content="GAsplund's Website">

		<!-- SCRIPT -->
		<script src="https://www.w3schools.com/lib/w3.js"></script>
		<script src="//code.jquery.com/jquery-2.2.1.min.js"></script>
		<script src="//momentjs.com/downloads/moment.min.js"></script>
		<script src="//ujafedny.org/assets/bower_components/moment/locale/*.js"></script> 
		
		<script>
		var rq = '//mcapi.us/server/status?ip=gasplund.mc-server.net';
		var error = 'unknown';
		var classes = {
			error: "fa-question",
			false: "fa-times",
			true: "fa-check",
		};
		var allclasses = "";
		for(i in classes) {
			allclasses += ' '+classes[i];
		};
		function q(addr, cb) {
			$.ajax({
				url: rq,
				type: 'GET',
				dataType: 'json',
				data: {ip: addr, players: true},
			})
			.done(function(data) {
				console.log("success");
				console.log(data);
				cb(data);
			})
			.fail(function(data) {
				console.log("error");
			})
			.always(function() {
			});
		}
		function setclass(o, c) {
			o.removeClass(allclasses);
			o.addClass(classes[c]);
			o.html('');
		}
		function settext(o, t) {
			o.removeClass(allclasses);
			o.html(t);
		}
		function display(data) {
			var np = $('#numplayers'),
				version = $('#version'),
				online = $('#online'),
				motd = $('#motd'),
				updated = $('#updated'),
				d = new Date(data.last_updated*1000);
			moment.locale('*');				// The locale which you have used before.
			settext(updated, moment(d).fromNow());
			setclass(online, data.online);
			if (data.online) {
			settext(np, data.players.now);
			settext(version, data.server.name);
			settext(motd, data.motd);
			} else {
			setclass(np, error);
			setclass(version, error);
			setclass(motd, error);
			}
		}
		$(document).ready(function() {
			q('//lentium.xyz', display);
		});
		</script>

		<style type="text/css" media="screen">
			.statusbox {
				min-width: 5em;
				min-height: 2em;
				border: 1px solid #999;
				background-color: #eee;
				padding: 0.5em;
				margin: 0.5em;
				width: 20%;
			}
			.label {
				text-align: right;
				float: left;
				margin-right: 1em;
				min-width: 4em;
				color: #444;
			}
		</style>
		
	</head>

	<body>

		<div id="header"><h1>GAsplund</h1></div>

		<div w3-include-html="navigation.html"></div>
		<div w3-include-html="copyright.html"></div>
		<script>w3.includeHTML();</script>
		<!-- Place code under this comment -->

		<div style="padding-left:0.5em; padding-top:2%; font-family:Trebuchet MS">
			<h1><i class="fa fa-refresh" aria-hidden="true"></i> Server Status:</h1>
		</div>

		<div class="statusbox">
			<span class="label">Online: </span>
			<i id="online" class="fa fa-question"></i>
			<br>
			<span class="label">Players: </span>
			<i id="numplayers" class="fa fa-question"></i>
			<br>
			<div class="label">Version: </div>
			<i id="version" class="fa fa-question"></i>
			<br>
			<span class="label">MOTD: </span>
			<i id="motd" class="fa fa-question"></i>
			<br>
			<br>
			<span class="label">Refresh: </span><form><input type="button" onClick="history.go(0)" value="â†º"></form>
		</div>

	</body>

</html>
